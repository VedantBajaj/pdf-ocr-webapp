<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PDF OCR Web App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: 'class'
      };
    </script>
    <script>
      // Persist dark mode
      if (localStorage.getItem("theme") === "dark") {
        document.documentElement.classList.add("dark");
      }
      function toggleTheme() {
        document.documentElement.classList.toggle("dark");
        localStorage.setItem("theme", document.documentElement.classList.contains("dark") ? "dark" : "light");
      }
    </script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 dark:text-white min-h-screen font-sans">

    <!-- Header -->
    <header class="bg-indigo-600 dark:bg-indigo-800 text-white p-4 text-center shadow">
        <h1 class="text-3xl font-bold">PDF Text Extractor</h1>
        <p class="text-sm">Upload a PDF and extract readable text using OCR</p>
    </header>

    <!-- Dark Mode Toggle -->
    <div class="text-right p-4">
        <button onclick="toggleTheme()" class="bg-white dark:bg-black text-black dark:text-white px-3 py-1 rounded shadow">
            Toggle Mode üåô
        </button>
    </div>

    <!-- Main Section -->
    <main class="max-w-3xl mx-auto mt-10 bg-white dark:bg-gray-800 p-6 rounded shadow">
        <form method="post" enctype="multipart/form-data" class="space-y-4">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 transition dark:bg-indigo-500 dark:hover:bg-indigo-600">
                Upload & Extract
            </button>
        </form>

        {% if text_output %}
            <div class="mt-8">
                <h2 class="text-xl font-semibold mb-2">üìù Extracted Text:</h2>
                <textarea class="w-full h-64 p-3 border rounded resize-none bg-gray-50 dark:bg-gray-700 dark:text-white" readonly>{{ text_output }}</textarea>
                <div class="mt-3 flex gap-3">
                    <button onclick="copyText()" class="bg-gray-800 text-white px-3 py-1 rounded hover:bg-gray-900">
                        Copy Text
                    </button>
                    <a href="#" onclick="downloadText()" class="bg-green-600 dark:bg-green-500 text-white px-3 py-1 rounded hover:bg-green-700 dark:hover:bg-green-600">
                        Download as .txt
                    </a>
                </div>
            </div>
        {% endif %}
    </main>

    <!-- Footer -->
    <footer class="text-center mt-10 text-sm text-gray-500 dark:text-gray-400">
        Made with ‚ù§Ô∏è using Django & Tesseract OCR
    </footer>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-5 right-5 bg-green-600 text-white px-4 py-2 rounded shadow hidden z-50"></div>

    <!-- Spinner -->
    <div id="loader" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center hidden z-50">
        <div class="border-t-4 border-white w-12 h-12 rounded-full animate-spin"></div>
    </div>

    <!-- Scripts -->
    <script>
        function copyText() {
            const text = document.querySelector('textarea');
            text.select();
            document.execCommand('copy');
            showToast('Copied to clipboard!');
        }

        function downloadText() {
            const text = document.querySelector('textarea').value;
            const blob = new Blob([text], { type: 'text/plain' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = "extracted_text.txt";
            link.click();
        }

        function showToast(message) {
            const toast = document.getElementById("toast");
            toast.innerText = message;
            toast.classList.remove("hidden");
            setTimeout(() => {
                toast.classList.add("hidden");
            }, 3000);
        }

        const form = document.querySelector("form");
        form.addEventListener("submit", () => {
            document.getElementById("loader").classList.remove("hidden");
        });
    </script>
</body>
</html>